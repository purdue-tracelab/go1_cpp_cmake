#include "go1_cpp_cmake/go1FK.h"

/*
    go1FK.cpp sets up the forward kinematics of Go1, so we can find the
    foot locations based on the joint angles of the system. Right now,
    the function is configured to find the foot positions relative to
    the base (trunk) of Go1, but the absolute foot positions can be found
    by adding the base location to the relative foot locations. go1FK.cpp
    also sets up the Jacobian describing the connection between joint
    velocities and the resulting linear foot velocities.
*/

Eigen::Matrix4d transformMat(const Eigen::Matrix3d &rotMat, const double dispX, const double dispY, const double dispZ) {
/*
    Finds a transformation matrix to represent translation and rotation
    between two frames. Very useful for forward kinematics.
*/
    Eigen::Matrix4d transformRot = Eigen::Matrix4d::Identity();
    transformRot.block<3, 3>(0, 0) = rotMat;

    Eigen::Matrix4d transformDisp = Eigen::Matrix4d::Identity();
    transformDisp(0, 3) = dispX;
    transformDisp(1, 3) = dispY;
    transformDisp(2, 3) = dispZ;

    return transformRot * transformDisp;
}

Eigen::Matrix<double, 3, NUM_LEG> go1FKMujoco(const mjtNum* q_vec, const Eigen::Vector3d &root_rpy) {
/*
    Finds the transformation matrices between the base and the feet of Go1
    using successive transformations based on the joint positions relayed
    to it from MuJoCo simulations.
*/
    if (!q_vec) {
        std::cerr << "Error: q_vec is NULL!" << std::endl;
        return Eigen::Matrix<double, 3, NUM_LEG>::Zero();
    }

    double roll = root_rpy(0);
    double pitch = root_rpy(1);
    double yaw = root_rpy(2);

    double qFR0 = q_vec[7], qFR1 = q_vec[8], qFR2 = q_vec[9];
    double qFL0 = q_vec[10], qFL1 = q_vec[11], qFL2 = q_vec[12];
    double qRR0 = q_vec[13], qRR1 = q_vec[14], qRR2 = q_vec[15];
    double qRL0 = q_vec[16], qRL1 = q_vec[17], qRL2 = q_vec[18];

    Eigen::Vector3d rHip(0.1881, 0.04675, 0.0);
    Eigen::Vector3d rThigh(0.0, 0.08, 0.0);
    Eigen::Vector3d rCalf(0.0, 0.0, -0.213);
    Eigen::Vector3d rFoot(0.0, 0.0, -0.213);

    Eigen::Matrix4d H_hipFR = transformMat(rotZ(yaw)*rotY(pitch)*rotX(roll), rHip(0), -rHip(1), rHip(2));
    Eigen::Matrix4d H_hipFL = transformMat(rotZ(yaw)*rotY(pitch)*rotX(roll), rHip(0), rHip(1), rHip(2));
    Eigen::Matrix4d H_hipRR = transformMat(rotZ(yaw)*rotY(pitch)*rotX(roll), -rHip(0), -rHip(1), rHip(2));
    Eigen::Matrix4d H_hipRL = transformMat(rotZ(yaw)*rotY(pitch)*rotX(roll), -rHip(0), rHip(1), rHip(2));

    Eigen::Matrix4d H_thighFR = transformMat(rotX(qFR0), rThigh(0), -rThigh(1), rThigh(2));
    Eigen::Matrix4d H_thighFL = transformMat(rotX(qFL0), rThigh(0), rThigh(1), rThigh(2));
    Eigen::Matrix4d H_thighRR = transformMat(rotX(qRR0), -rThigh(0), -rThigh(1), rThigh(2));
    Eigen::Matrix4d H_thighRL = transformMat(rotX(qRL0), -rThigh(0), rThigh(1), rThigh(2));

    Eigen::Matrix4d H_calfFR = transformMat(rotY(qFR1), rCalf(0), rCalf(1), rCalf(2));
    Eigen::Matrix4d H_calfFL = transformMat(rotY(qFL1), rCalf(0), rCalf(1), rCalf(2));
    Eigen::Matrix4d H_calfRR = transformMat(rotY(qRR1), rCalf(0), rCalf(1), rCalf(2));
    Eigen::Matrix4d H_calfRL = transformMat(rotY(qRL1), rCalf(0), rCalf(1), rCalf(2));

    Eigen::Matrix4d H_footFR = transformMat(rotY(qFR2), rFoot(0), rFoot(1), rFoot(2));
    Eigen::Matrix4d H_footFL = transformMat(rotY(qFL2), rFoot(0), rFoot(1), rFoot(2));
    Eigen::Matrix4d H_footRR = transformMat(rotY(qRR2), rFoot(0), rFoot(1), rFoot(2));
    Eigen::Matrix4d H_footRL = transformMat(rotY(qRL2), rFoot(0), rFoot(1), rFoot(2));

    Eigen::Vector4d originPos(0, 0, 0, 1);

    Eigen::Matrix<double, 3, NUM_LEG> footPosMat;
    footPosMat.col(0) = (H_hipFR * H_thighFR * H_calfFR * H_footFR * originPos).head<3>();
    footPosMat.col(1) = (H_hipFL * H_thighFL * H_calfFL * H_footFL * originPos).head<3>();
    footPosMat.col(2) = (H_hipRR * H_thighRR * H_calfRR * H_footRR * originPos).head<3>();
    footPosMat.col(3) = (H_hipRL * H_thighRL * H_calfRL * H_footRL * originPos).head<3>();

    return footPosMat;

}

Eigen::MatrixXd go1FootJacMujoco(const mjtNum* q_vec, const Eigen::Vector3d &root_rpy) {
/*
    Finds the Jacobian connecting the joint velocities to their corresponding
    linear foot velocities. One Jacobian is constructed per foot, and then is
    stacked on top of each other for convenient access. Based on joint positions
    relayed to it from MuJoCo simulations.
*/
    if (!q_vec) {
        std::cerr << "Error: q_vec is NULL!" << std::endl;
        return Eigen::Matrix<double, 3, NUM_LEG>::Zero();
    }

    double roll = root_rpy(0);
    double pitch = root_rpy(1);
    double yaw = root_rpy(2);

    double qFR0 = q_vec[7], qFR1 = q_vec[8], qFR2 = q_vec[9];
    double qFL0 = q_vec[10], qFL1 = q_vec[11], qFL2 = q_vec[12];
    double qRR0 = q_vec[13], qRR1 = q_vec[14], qRR2 = q_vec[15];
    double qRL0 = q_vec[16], qRL1 = q_vec[17], qRL2 = q_vec[18];

    Eigen::MatrixXd JvFR(3, 18);
    Eigen::MatrixXd JvFL(3, 18);
    Eigen::MatrixXd JvRR(3, 18);
    Eigen::MatrixXd JvRL(3, 18);

    JvFR << 1.0, 0, 0, (213.0*sin(qFR1)*sin(qFR2)*(cos(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000.0 - (187.0*sin(roll)*sin(yaw))/4000.0 - (2.0*cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25.0 - (2.0*sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25.0 - (213.0*cos(qFR1)*(cos(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000.0 - (213.0*cos(qFR1)*cos(qFR2)*(cos(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000.0 - (187.0*cos(roll)*cos(yaw)*sin(pitch))/4000.0, (213.0*sin(qFR2)*(sin(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qFR0)*sin(roll)) + cos(qFR1)*cos(yaw)*sin(pitch)))/1000.0 - (213.0*cos(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qFR0)*sin(roll)))/1000.0 - (213.0*cos(qFR2)*(cos(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qFR0)*sin(roll)) - cos(yaw)*sin(pitch)*sin(qFR1)))/1000.0 - (1881.0*cos(yaw)*sin(pitch))/10000.0 + (213.0*cos(yaw)*sin(pitch)*sin(qFR1))/1000.0 - (187.0*cos(pitch)*cos(yaw)*sin(roll))/4000.0 - (2.0*cos(pitch)*cos(qFR0)*cos(yaw)*sin(roll))/25.0 - (2.0*cos(pitch)*cos(roll)*cos(yaw)*sin(qFR0))/25.0, (187*cos(roll)*cos(yaw))/4000 - (213*cos(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 - (1881*cos(pitch)*sin(yaw))/10000 - (213*cos(qFR2)*(cos(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qFR1)*sin(yaw)))/1000 + (2*cos(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 + (213*sin(qFR2)*(sin(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qFR1)*sin(yaw)))/1000 - (2*sin(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (213*cos(pitch)*sin(qFR1)*sin(yaw))/1000 + (187*sin(pitch)*sin(roll)*sin(yaw))/4000, (213*sin(qFR1)*sin(qFR2)*(cos(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (2*cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 - (2*sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 - (213*cos(qFR1)*(cos(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (213*cos(qFR1)*cos(qFR2)*(cos(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000,   (213*sin(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 + (213*cos(qFR2)*(sin(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qFR1)*cos(yaw)))/1000 + (213*sin(qFR2)*(cos(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qFR1)))/1000 - (213*cos(pitch)*cos(qFR1)*cos(yaw))/1000,   (213*cos(qFR2)*(sin(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qFR1)*cos(yaw)))/1000 + (213*sin(qFR2)*(cos(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qFR1)))/1000, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 1.0, 0, (213*cos(qFR1)*(cos(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (187*cos(yaw)*sin(roll))/4000 + (2*cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (2*sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 - (187*cos(roll)*sin(pitch)*sin(yaw))/4000 - (213*sin(qFR1)*sin(qFR2)*(cos(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qFR1)*cos(qFR2)*(cos(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, (213*sin(qFR2)*(sin(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qFR0)*sin(roll)*sin(yaw)) + cos(qFR1)*sin(pitch)*sin(yaw)))/1000 - (1881*sin(pitch)*sin(yaw))/10000 - (213*cos(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qFR0)*sin(roll)*sin(yaw)))/1000 - (213*cos(qFR2)*(cos(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qFR0)*sin(roll)*sin(yaw)) - sin(pitch)*sin(qFR1)*sin(yaw)))/1000 - (187*cos(pitch)*sin(roll)*sin(yaw))/4000 + (213*sin(pitch)*sin(qFR1)*sin(yaw))/1000 - (2*cos(pitch)*cos(qFR0)*sin(roll)*sin(yaw))/25 - (2*cos(pitch)*cos(roll)*sin(qFR0)*sin(yaw))/25, (1881*cos(pitch)*cos(yaw))/10000 - (213*cos(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 + (187*cos(roll)*sin(yaw))/4000 - (213*cos(qFR2)*(cos(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qFR1)))/1000 + (213*sin(qFR2)*(sin(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qFR1)*cos(yaw)))/1000 + (2*cos(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 - (2*sin(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 - (187*cos(yaw)*sin(pitch)*sin(roll))/4000 - (213*cos(pitch)*cos(yaw)*sin(qFR1))/1000, (213*cos(qFR1)*(cos(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (2*cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (2*sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 - (213*sin(qFR1)*sin(qFR2)*(cos(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qFR1)*cos(qFR2)*(cos(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, - (213*sin(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 - (213*cos(qFR2)*(sin(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qFR1)*sin(yaw)))/1000 - (213*sin(qFR2)*(cos(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qFR1)*sin(yaw)))/1000 - (213*cos(pitch)*cos(qFR1)*sin(yaw))/1000, - (213*cos(qFR2)*(sin(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qFR1)*sin(yaw)))/1000 - (213*sin(qFR2)*(cos(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qFR1)*sin(yaw)))/1000, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 1.0,                                                                                                                                                                                                                                                                                                          (213*cos(qFR1)*(cos(pitch)*cos(qFR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFR0)))/1000 - (187*cos(pitch)*cos(roll))/4000 + (213*cos(qFR1)*cos(qFR2)*(cos(pitch)*cos(qFR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFR0)))/1000 - (213*sin(qFR1)*sin(qFR2)*(cos(pitch)*cos(qFR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFR0)))/1000 - (2*cos(pitch)*cos(qFR0)*cos(roll))/25 + (2*cos(pitch)*sin(qFR0)*sin(roll))/25,                                                                                                                      (213*cos(pitch)*sin(qFR1))/1000 - (1881*cos(pitch))/10000 + (187*sin(pitch)*sin(roll))/4000 + (213*cos(qFR2)*(cos(pitch)*sin(qFR1) - cos(qFR1)*(sin(pitch)*sin(qFR0)*sin(roll) - cos(qFR0)*cos(roll)*sin(pitch))))/1000 + (213*sin(qFR2)*(cos(pitch)*cos(qFR1) + sin(qFR1)*(sin(pitch)*sin(qFR0)*sin(roll) - cos(qFR0)*cos(roll)*sin(pitch))))/1000 - (213*cos(qFR1)*(sin(pitch)*sin(qFR0)*sin(roll) - cos(qFR0)*cos(roll)*sin(pitch)))/1000 + (2*cos(qFR0)*sin(pitch)*sin(roll))/25 + (2*cos(roll)*sin(pitch)*sin(qFR0))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                 (213*cos(qFR1)*(cos(pitch)*cos(qFR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFR0)))/1000 + (213*cos(qFR1)*cos(qFR2)*(cos(pitch)*cos(qFR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFR0)))/1000 - (213*sin(qFR1)*sin(qFR2)*(cos(pitch)*cos(qFR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFR0)))/1000 - (2*cos(pitch)*cos(qFR0)*cos(roll))/25 + (2*cos(pitch)*sin(qFR0)*sin(roll))/25,                                                                                                                                                                                                                              (213*cos(qFR1)*sin(pitch))/1000 + (213*cos(qFR2)*(cos(qFR1)*sin(pitch) + sin(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll) - cos(pitch)*sin(qFR0)*sin(roll))))/1000 - (213*sin(qFR2)*(sin(pitch)*sin(qFR1) - cos(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll) - cos(pitch)*sin(qFR0)*sin(roll))))/1000 + (213*sin(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll) - cos(pitch)*sin(qFR0)*sin(roll)))/1000,                                                                                                                                                     (213*cos(qFR2)*(cos(qFR1)*sin(pitch) + sin(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll) - cos(pitch)*sin(qFR0)*sin(roll))))/1000 - (213*sin(qFR2)*(sin(pitch)*sin(qFR1) - cos(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll) - cos(pitch)*sin(qFR0)*sin(roll))))/1000, 0, 0, 0, 0, 0, 0, 0, 0, 0;
 
    JvFL << 1.0, 0, 0, (187*sin(roll)*sin(yaw))/4000 - (213*cos(qFL1)*(cos(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 + (2*cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 + (2*sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 + (213*sin(qFL1)*sin(qFL2)*(cos(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (213*cos(qFL1)*cos(qFL2)*(cos(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 + (187*cos(roll)*cos(yaw)*sin(pitch))/4000, (213*sin(qFL2)*(sin(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qFL0)*sin(roll)) + cos(qFL1)*cos(yaw)*sin(pitch)))/1000 - (213*cos(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qFL0)*sin(roll)))/1000 - (213*cos(qFL2)*(cos(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qFL0)*sin(roll)) - cos(yaw)*sin(pitch)*sin(qFL1)))/1000 - (1881*cos(yaw)*sin(pitch))/10000 + (213*cos(yaw)*sin(pitch)*sin(qFL1))/1000 + (187*cos(pitch)*cos(yaw)*sin(roll))/4000 + (2*cos(pitch)*cos(qFL0)*cos(yaw)*sin(roll))/25 + (2*cos(pitch)*cos(roll)*cos(yaw)*sin(qFL0))/25, (213*sin(qFL2)*(sin(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qFL1)*sin(yaw)))/1000 - (213*cos(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 - (1881*cos(pitch)*sin(yaw))/10000 - (213*cos(qFL2)*(cos(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qFL1)*sin(yaw)))/1000 - (2*cos(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 - (187*cos(roll)*cos(yaw))/4000 + (2*sin(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (213*cos(pitch)*sin(qFL1)*sin(yaw))/1000 - (187*sin(pitch)*sin(roll)*sin(yaw))/4000, 0, 0, 0, (2*cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 - (213*cos(qFL1)*(cos(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 + (2*sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 + (213*sin(qFL1)*sin(qFL2)*(cos(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (213*cos(qFL1)*cos(qFL2)*(cos(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000,   (213*sin(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 + (213*cos(qFL2)*(sin(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qFL1)*cos(yaw)))/1000 + (213*sin(qFL2)*(cos(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qFL1)))/1000 - (213*cos(pitch)*cos(qFL1)*cos(yaw))/1000,   (213*cos(qFL2)*(sin(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qFL1)*cos(yaw)))/1000 + (213*sin(qFL2)*(cos(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qFL1)))/1000, 0, 0, 0, 0, 0, 0,
            0, 1.0, 0, (213*cos(qFL1)*(cos(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 - (187*cos(yaw)*sin(roll))/4000 - (2*cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 - (2*sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 + (187*cos(roll)*sin(pitch)*sin(yaw))/4000 - (213*sin(qFL1)*sin(qFL2)*(cos(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qFL1)*cos(qFL2)*(cos(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, (213*sin(qFL2)*(sin(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qFL0)*sin(roll)*sin(yaw)) + cos(qFL1)*sin(pitch)*sin(yaw)))/1000 - (1881*sin(pitch)*sin(yaw))/10000 - (213*cos(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qFL0)*sin(roll)*sin(yaw)))/1000 - (213*cos(qFL2)*(cos(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qFL0)*sin(roll)*sin(yaw)) - sin(pitch)*sin(qFL1)*sin(yaw)))/1000 + (187*cos(pitch)*sin(roll)*sin(yaw))/4000 + (213*sin(pitch)*sin(qFL1)*sin(yaw))/1000 + (2*cos(pitch)*cos(qFL0)*sin(roll)*sin(yaw))/25 + (2*cos(pitch)*cos(roll)*sin(qFL0)*sin(yaw))/25, (1881*cos(pitch)*cos(yaw))/10000 - (213*cos(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 - (187*cos(roll)*sin(yaw))/4000 - (213*cos(qFL2)*(cos(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qFL1)))/1000 + (213*sin(qFL2)*(sin(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qFL1)*cos(yaw)))/1000 - (2*cos(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 + (2*sin(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 + (187*cos(yaw)*sin(pitch)*sin(roll))/4000 - (213*cos(pitch)*cos(yaw)*sin(qFL1))/1000, 0, 0, 0, (213*cos(qFL1)*(cos(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 - (2*cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 - (2*sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 - (213*sin(qFL1)*sin(qFL2)*(cos(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qFL1)*cos(qFL2)*(cos(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, - (213*sin(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 - (213*cos(qFL2)*(sin(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qFL1)*sin(yaw)))/1000 - (213*sin(qFL2)*(cos(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qFL1)*sin(yaw)))/1000 - (213*cos(pitch)*cos(qFL1)*sin(yaw))/1000, - (213*cos(qFL2)*(sin(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qFL1)*sin(yaw)))/1000 - (213*sin(qFL2)*(cos(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qFL1)*sin(yaw)))/1000, 0, 0, 0, 0, 0, 0,
            0, 0, 1.0,                                                                                                                                                                                                                                                                                                          (187*cos(pitch)*cos(roll))/4000 + (213*cos(qFL1)*(cos(pitch)*cos(qFL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFL0)))/1000 + (213*cos(qFL1)*cos(qFL2)*(cos(pitch)*cos(qFL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFL0)))/1000 - (213*sin(qFL1)*sin(qFL2)*(cos(pitch)*cos(qFL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFL0)))/1000 + (2*cos(pitch)*cos(qFL0)*cos(roll))/25 - (2*cos(pitch)*sin(qFL0)*sin(roll))/25,                                                                                                                      (213*cos(pitch)*sin(qFL1))/1000 - (1881*cos(pitch))/10000 - (187*sin(pitch)*sin(roll))/4000 + (213*cos(qFL2)*(cos(pitch)*sin(qFL1) - cos(qFL1)*(sin(pitch)*sin(qFL0)*sin(roll) - cos(qFL0)*cos(roll)*sin(pitch))))/1000 + (213*sin(qFL2)*(cos(pitch)*cos(qFL1) + sin(qFL1)*(sin(pitch)*sin(qFL0)*sin(roll) - cos(qFL0)*cos(roll)*sin(pitch))))/1000 - (213*cos(qFL1)*(sin(pitch)*sin(qFL0)*sin(roll) - cos(qFL0)*cos(roll)*sin(pitch)))/1000 - (2*cos(qFL0)*sin(pitch)*sin(roll))/25 - (2*cos(roll)*sin(pitch)*sin(qFL0))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0, 0, 0, 0,                                                                                                                                                                                                                                                                 (213*cos(qFL1)*(cos(pitch)*cos(qFL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFL0)))/1000 + (213*cos(qFL1)*cos(qFL2)*(cos(pitch)*cos(qFL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFL0)))/1000 - (213*sin(qFL1)*sin(qFL2)*(cos(pitch)*cos(qFL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFL0)))/1000 + (2*cos(pitch)*cos(qFL0)*cos(roll))/25 - (2*cos(pitch)*sin(qFL0)*sin(roll))/25,                                                                                                                                                                                                                              (213*cos(qFL1)*sin(pitch))/1000 + (213*cos(qFL2)*(cos(qFL1)*sin(pitch) + sin(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll) - cos(pitch)*sin(qFL0)*sin(roll))))/1000 - (213*sin(qFL2)*(sin(pitch)*sin(qFL1) - cos(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll) - cos(pitch)*sin(qFL0)*sin(roll))))/1000 + (213*sin(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll) - cos(pitch)*sin(qFL0)*sin(roll)))/1000,                                                                                                                                                     (213*cos(qFL2)*(cos(qFL1)*sin(pitch) + sin(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll) - cos(pitch)*sin(qFL0)*sin(roll))))/1000 - (213*sin(qFL2)*(sin(pitch)*sin(qFL1) - cos(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll) - cos(pitch)*sin(qFL0)*sin(roll))))/1000, 0, 0, 0, 0, 0, 0;
 
    JvRR << 1.0, 0, 0, (213*sin(qRR1)*sin(qRR2)*(cos(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (187*sin(roll)*sin(yaw))/4000 - (2*cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 - (2*sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 - (213*cos(qRR1)*(cos(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (213*cos(qRR1)*cos(qRR2)*(cos(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (187*cos(roll)*cos(yaw)*sin(pitch))/4000, (1881*cos(yaw)*sin(pitch))/10000 - (213*cos(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qRR0)*sin(roll)))/1000 - (213*cos(qRR2)*(cos(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qRR0)*sin(roll)) - cos(yaw)*sin(pitch)*sin(qRR1)))/1000 + (213*sin(qRR2)*(sin(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qRR0)*sin(roll)) + cos(qRR1)*cos(yaw)*sin(pitch)))/1000 + (213*cos(yaw)*sin(pitch)*sin(qRR1))/1000 - (187*cos(pitch)*cos(yaw)*sin(roll))/4000 - (2*cos(pitch)*cos(qRR0)*cos(yaw)*sin(roll))/25 - (2*cos(pitch)*cos(roll)*cos(yaw)*sin(qRR0))/25, (187*cos(roll)*cos(yaw))/4000 - (213*cos(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 + (1881*cos(pitch)*sin(yaw))/10000 - (213*cos(qRR2)*(cos(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qRR1)*sin(yaw)))/1000 + (2*cos(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 + (213*sin(qRR2)*(sin(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qRR1)*sin(yaw)))/1000 - (2*sin(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (213*cos(pitch)*sin(qRR1)*sin(yaw))/1000 + (187*sin(pitch)*sin(roll)*sin(yaw))/4000, 0, 0, 0, 0, 0, 0, (213*sin(qRR1)*sin(qRR2)*(cos(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (2*cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 - (2*sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 - (213*cos(qRR1)*(cos(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (213*cos(qRR1)*cos(qRR2)*(cos(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000,   (213*sin(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 + (213*cos(qRR2)*(sin(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qRR1)*cos(yaw)))/1000 + (213*sin(qRR2)*(cos(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qRR1)))/1000 - (213*cos(pitch)*cos(qRR1)*cos(yaw))/1000,   (213*cos(qRR2)*(sin(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qRR1)*cos(yaw)))/1000 + (213*sin(qRR2)*(cos(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qRR1)))/1000, 0, 0, 0,
            0, 1.0, 0, (213*cos(qRR1)*(cos(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (187*cos(yaw)*sin(roll))/4000 + (2*cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (2*sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 - (187*cos(roll)*sin(pitch)*sin(yaw))/4000 - (213*sin(qRR1)*sin(qRR2)*(cos(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qRR1)*cos(qRR2)*(cos(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, (213*sin(qRR2)*(sin(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qRR0)*sin(roll)*sin(yaw)) + cos(qRR1)*sin(pitch)*sin(yaw)))/1000 + (1881*sin(pitch)*sin(yaw))/10000 - (213*cos(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qRR0)*sin(roll)*sin(yaw)))/1000 - (213*cos(qRR2)*(cos(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qRR0)*sin(roll)*sin(yaw)) - sin(pitch)*sin(qRR1)*sin(yaw)))/1000 - (187*cos(pitch)*sin(roll)*sin(yaw))/4000 + (213*sin(pitch)*sin(qRR1)*sin(yaw))/1000 - (2*cos(pitch)*cos(qRR0)*sin(roll)*sin(yaw))/25 - (2*cos(pitch)*cos(roll)*sin(qRR0)*sin(yaw))/25, (187*cos(roll)*sin(yaw))/4000 - (213*cos(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 - (1881*cos(pitch)*cos(yaw))/10000 - (213*cos(qRR2)*(cos(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qRR1)))/1000 + (213*sin(qRR2)*(sin(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qRR1)*cos(yaw)))/1000 + (2*cos(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 - (2*sin(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 - (187*cos(yaw)*sin(pitch)*sin(roll))/4000 - (213*cos(pitch)*cos(yaw)*sin(qRR1))/1000, 0, 0, 0, 0, 0, 0, (213*cos(qRR1)*(cos(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (2*cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (2*sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 - (213*sin(qRR1)*sin(qRR2)*(cos(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qRR1)*cos(qRR2)*(cos(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, - (213*sin(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 - (213*cos(qRR2)*(sin(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qRR1)*sin(yaw)))/1000 - (213*sin(qRR2)*(cos(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qRR1)*sin(yaw)))/1000 - (213*cos(pitch)*cos(qRR1)*sin(yaw))/1000, - (213*cos(qRR2)*(sin(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qRR1)*sin(yaw)))/1000 - (213*sin(qRR2)*(cos(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qRR1)*sin(yaw)))/1000, 0, 0, 0,
            0, 0, 1.0,                                                                                                                                                                                                                                                                                                          (213*cos(qRR1)*(cos(pitch)*cos(qRR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRR0)))/1000 - (187*cos(pitch)*cos(roll))/4000 + (213*cos(qRR1)*cos(qRR2)*(cos(pitch)*cos(qRR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRR0)))/1000 - (213*sin(qRR1)*sin(qRR2)*(cos(pitch)*cos(qRR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRR0)))/1000 - (2*cos(pitch)*cos(qRR0)*cos(roll))/25 + (2*cos(pitch)*sin(qRR0)*sin(roll))/25,                                                                                                                      (1881*cos(pitch))/10000 + (213*cos(pitch)*sin(qRR1))/1000 + (187*sin(pitch)*sin(roll))/4000 + (213*cos(qRR2)*(cos(pitch)*sin(qRR1) - cos(qRR1)*(sin(pitch)*sin(qRR0)*sin(roll) - cos(qRR0)*cos(roll)*sin(pitch))))/1000 + (213*sin(qRR2)*(cos(pitch)*cos(qRR1) + sin(qRR1)*(sin(pitch)*sin(qRR0)*sin(roll) - cos(qRR0)*cos(roll)*sin(pitch))))/1000 - (213*cos(qRR1)*(sin(pitch)*sin(qRR0)*sin(roll) - cos(qRR0)*cos(roll)*sin(pitch)))/1000 + (2*cos(qRR0)*sin(pitch)*sin(roll))/25 + (2*cos(roll)*sin(pitch)*sin(qRR0))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0, 0, 0, 0, 0, 0, 0,                                                                                                                                                                                                                                                                 (213*cos(qRR1)*(cos(pitch)*cos(qRR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRR0)))/1000 + (213*cos(qRR1)*cos(qRR2)*(cos(pitch)*cos(qRR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRR0)))/1000 - (213*sin(qRR1)*sin(qRR2)*(cos(pitch)*cos(qRR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRR0)))/1000 - (2*cos(pitch)*cos(qRR0)*cos(roll))/25 + (2*cos(pitch)*sin(qRR0)*sin(roll))/25,                                                                                                                                                                                                                              (213*cos(qRR1)*sin(pitch))/1000 + (213*cos(qRR2)*(cos(qRR1)*sin(pitch) + sin(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll) - cos(pitch)*sin(qRR0)*sin(roll))))/1000 - (213*sin(qRR2)*(sin(pitch)*sin(qRR1) - cos(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll) - cos(pitch)*sin(qRR0)*sin(roll))))/1000 + (213*sin(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll) - cos(pitch)*sin(qRR0)*sin(roll)))/1000,                                                                                                                                                     (213*cos(qRR2)*(cos(qRR1)*sin(pitch) + sin(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll) - cos(pitch)*sin(qRR0)*sin(roll))))/1000 - (213*sin(qRR2)*(sin(pitch)*sin(qRR1) - cos(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll) - cos(pitch)*sin(qRR0)*sin(roll))))/1000, 0, 0, 0;
 
    JvRL << 1.0, 0, 0, (187*sin(roll)*sin(yaw))/4000 - (213*cos(qRL1)*(cos(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 + (2*cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 + (2*sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 + (213*sin(qRL1)*sin(qRL2)*(cos(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (213*cos(qRL1)*cos(qRL2)*(cos(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 + (187*cos(roll)*cos(yaw)*sin(pitch))/4000, (1881*cos(yaw)*sin(pitch))/10000 - (213*cos(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qRL0)*sin(roll)))/1000 - (213*cos(qRL2)*(cos(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qRL0)*sin(roll)) - cos(yaw)*sin(pitch)*sin(qRL1)))/1000 + (213*sin(qRL2)*(sin(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qRL0)*sin(roll)) + cos(qRL1)*cos(yaw)*sin(pitch)))/1000 + (213*cos(yaw)*sin(pitch)*sin(qRL1))/1000 + (187*cos(pitch)*cos(yaw)*sin(roll))/4000 + (2*cos(pitch)*cos(qRL0)*cos(yaw)*sin(roll))/25 + (2*cos(pitch)*cos(roll)*cos(yaw)*sin(qRL0))/25, (1881*cos(pitch)*sin(yaw))/10000 - (213*cos(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 - (187*cos(roll)*cos(yaw))/4000 - (213*cos(qRL2)*(cos(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qRL1)*sin(yaw)))/1000 - (2*cos(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 + (213*sin(qRL2)*(sin(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qRL1)*sin(yaw)))/1000 + (2*sin(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (213*cos(pitch)*sin(qRL1)*sin(yaw))/1000 - (187*sin(pitch)*sin(roll)*sin(yaw))/4000, 0, 0, 0, 0, 0, 0, 0, 0, 0, (2*cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 - (213*cos(qRL1)*(cos(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 + (2*sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 + (213*sin(qRL1)*sin(qRL2)*(cos(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (213*cos(qRL1)*cos(qRL2)*(cos(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000,   (213*sin(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 + (213*cos(qRL2)*(sin(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qRL1)*cos(yaw)))/1000 + (213*sin(qRL2)*(cos(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qRL1)))/1000 - (213*cos(pitch)*cos(qRL1)*cos(yaw))/1000,   (213*cos(qRL2)*(sin(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qRL1)*cos(yaw)))/1000 + (213*sin(qRL2)*(cos(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qRL1)))/1000,
            0, 1.0, 0, (213*cos(qRL1)*(cos(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 - (187*cos(yaw)*sin(roll))/4000 - (2*cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 - (2*sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 + (187*cos(roll)*sin(pitch)*sin(yaw))/4000 - (213*sin(qRL1)*sin(qRL2)*(cos(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qRL1)*cos(qRL2)*(cos(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, (213*sin(qRL2)*(sin(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qRL0)*sin(roll)*sin(yaw)) + cos(qRL1)*sin(pitch)*sin(yaw)))/1000 + (1881*sin(pitch)*sin(yaw))/10000 - (213*cos(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qRL0)*sin(roll)*sin(yaw)))/1000 - (213*cos(qRL2)*(cos(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qRL0)*sin(roll)*sin(yaw)) - sin(pitch)*sin(qRL1)*sin(yaw)))/1000 + (187*cos(pitch)*sin(roll)*sin(yaw))/4000 + (213*sin(pitch)*sin(qRL1)*sin(yaw))/1000 + (2*cos(pitch)*cos(qRL0)*sin(roll)*sin(yaw))/25 + (2*cos(pitch)*cos(roll)*sin(qRL0)*sin(yaw))/25, (213*sin(qRL2)*(sin(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qRL1)*cos(yaw)))/1000 - (213*cos(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 - (187*cos(roll)*sin(yaw))/4000 - (213*cos(qRL2)*(cos(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qRL1)))/1000 - (1881*cos(pitch)*cos(yaw))/10000 - (2*cos(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 + (2*sin(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 + (187*cos(yaw)*sin(pitch)*sin(roll))/4000 - (213*cos(pitch)*cos(yaw)*sin(qRL1))/1000, 0, 0, 0, 0, 0, 0, 0, 0, 0, (213*cos(qRL1)*(cos(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 - (2*cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 - (2*sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 - (213*sin(qRL1)*sin(qRL2)*(cos(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qRL1)*cos(qRL2)*(cos(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, - (213*sin(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 - (213*cos(qRL2)*(sin(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qRL1)*sin(yaw)))/1000 - (213*sin(qRL2)*(cos(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qRL1)*sin(yaw)))/1000 - (213*cos(pitch)*cos(qRL1)*sin(yaw))/1000, - (213*cos(qRL2)*(sin(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qRL1)*sin(yaw)))/1000 - (213*sin(qRL2)*(cos(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qRL1)*sin(yaw)))/1000,
            0, 0, 1.0,                                                                                                                                                                                                                                                                                                          (187*cos(pitch)*cos(roll))/4000 + (213*cos(qRL1)*(cos(pitch)*cos(qRL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRL0)))/1000 + (213*cos(qRL1)*cos(qRL2)*(cos(pitch)*cos(qRL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRL0)))/1000 - (213*sin(qRL1)*sin(qRL2)*(cos(pitch)*cos(qRL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRL0)))/1000 + (2*cos(pitch)*cos(qRL0)*cos(roll))/25 - (2*cos(pitch)*sin(qRL0)*sin(roll))/25,                                                                                                                      (1881*cos(pitch))/10000 + (213*cos(pitch)*sin(qRL1))/1000 - (187*sin(pitch)*sin(roll))/4000 + (213*cos(qRL2)*(cos(pitch)*sin(qRL1) - cos(qRL1)*(sin(pitch)*sin(qRL0)*sin(roll) - cos(qRL0)*cos(roll)*sin(pitch))))/1000 + (213*sin(qRL2)*(cos(pitch)*cos(qRL1) + sin(qRL1)*(sin(pitch)*sin(qRL0)*sin(roll) - cos(qRL0)*cos(roll)*sin(pitch))))/1000 - (213*cos(qRL1)*(sin(pitch)*sin(qRL0)*sin(roll) - cos(qRL0)*cos(roll)*sin(pitch)))/1000 - (2*cos(qRL0)*sin(pitch)*sin(roll))/25 - (2*cos(roll)*sin(pitch)*sin(qRL0))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,                                                                                                                                                                                                                                                                 (213*cos(qRL1)*(cos(pitch)*cos(qRL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRL0)))/1000 + (213*cos(qRL1)*cos(qRL2)*(cos(pitch)*cos(qRL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRL0)))/1000 - (213*sin(qRL1)*sin(qRL2)*(cos(pitch)*cos(qRL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRL0)))/1000 + (2*cos(pitch)*cos(qRL0)*cos(roll))/25 - (2*cos(pitch)*sin(qRL0)*sin(roll))/25,                                                                                                                                                                                                                              (213*cos(qRL1)*sin(pitch))/1000 + (213*cos(qRL2)*(cos(qRL1)*sin(pitch) + sin(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll) - cos(pitch)*sin(qRL0)*sin(roll))))/1000 - (213*sin(qRL2)*(sin(pitch)*sin(qRL1) - cos(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll) - cos(pitch)*sin(qRL0)*sin(roll))))/1000 + (213*sin(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll) - cos(pitch)*sin(qRL0)*sin(roll)))/1000,                                                                                                                                                     (213*cos(qRL2)*(cos(qRL1)*sin(pitch) + sin(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll) - cos(pitch)*sin(qRL0)*sin(roll))))/1000 - (213*sin(qRL2)*(sin(pitch)*sin(qRL1) - cos(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll) - cos(pitch)*sin(qRL0)*sin(roll))))/1000;

    Eigen::MatrixXd go1Jac(JvFL.rows() + JvFR.rows() + JvRL.rows() + JvRR.rows(), JvFL.cols());
    go1Jac << JvFR,
           JvFL,
           JvRR,
           JvRL;

    return go1Jac;
}

Eigen::Matrix<double, 3, NUM_LEG> go1FKHardware(const Eigen::VectorXd& jointPos, const Eigen::Vector3d& root_rpy) {
/*
    Finds the transformation matrices between the base and the feet of Go1
    using successive transformations based on the joint positions relayed
    to it from hardware.
*/
    double roll = root_rpy(0);
    double pitch = root_rpy(1);
    double yaw = root_rpy(2);

    double qFR0 = jointPos[0], qFR1 = jointPos[1], qFR2 = jointPos[2];
    double qFL0 = jointPos[3], qFL1 = jointPos[4], qFL2 = jointPos[5];
    double qRR0 = jointPos[6], qRR1 = jointPos[7], qRR2 = jointPos[8];
    double qRL0 = jointPos[9], qRL1 = jointPos[10], qRL2 = jointPos[11];

    Eigen::Vector3d rHip(0.1881, 0.04675, 0.0);
    Eigen::Vector3d rThigh(0.0, 0.08, 0.0);
    Eigen::Vector3d rCalf(0.0, 0.0, -0.213);
    Eigen::Vector3d rFoot(0.0, 0.0, -0.213);

    Eigen::Matrix4d H_hipFR = transformMat(rotZ(yaw)*rotY(pitch)*rotX(roll), rHip(0), -rHip(1), rHip(2));
    Eigen::Matrix4d H_hipFL = transformMat(rotZ(yaw)*rotY(pitch)*rotX(roll), rHip(0), rHip(1), rHip(2));
    Eigen::Matrix4d H_hipRR = transformMat(rotZ(yaw)*rotY(pitch)*rotX(roll), -rHip(0), -rHip(1), rHip(2));
    Eigen::Matrix4d H_hipRL = transformMat(rotZ(yaw)*rotY(pitch)*rotX(roll), -rHip(0), rHip(1), rHip(2));

    Eigen::Matrix4d H_thighFR = transformMat(rotX(qFR0), rThigh(0), -rThigh(1), rThigh(2));
    Eigen::Matrix4d H_thighFL = transformMat(rotX(qFL0), rThigh(0), rThigh(1), rThigh(2));
    Eigen::Matrix4d H_thighRR = transformMat(rotX(qRR0), -rThigh(0), -rThigh(1), rThigh(2));
    Eigen::Matrix4d H_thighRL = transformMat(rotX(qRL0), -rThigh(0), rThigh(1), rThigh(2));

    Eigen::Matrix4d H_calfFR = transformMat(rotY(qFR1), rCalf(0), rCalf(1), rCalf(2));
    Eigen::Matrix4d H_calfFL = transformMat(rotY(qFL1), rCalf(0), rCalf(1), rCalf(2));
    Eigen::Matrix4d H_calfRR = transformMat(rotY(qRR1), rCalf(0), rCalf(1), rCalf(2));
    Eigen::Matrix4d H_calfRL = transformMat(rotY(qRL1), rCalf(0), rCalf(1), rCalf(2));

    Eigen::Matrix4d H_footFR = transformMat(rotY(qFR2), rFoot(0), rFoot(1), rFoot(2));
    Eigen::Matrix4d H_footFL = transformMat(rotY(qFL2), rFoot(0), rFoot(1), rFoot(2));
    Eigen::Matrix4d H_footRR = transformMat(rotY(qRR2), rFoot(0), rFoot(1), rFoot(2));
    Eigen::Matrix4d H_footRL = transformMat(rotY(qRL2), rFoot(0), rFoot(1), rFoot(2));

    Eigen::Vector4d originPos(0, 0, 0, 1);

    Eigen::Matrix<double, 3, NUM_LEG> footPosMat;
    footPosMat.col(0) = (H_hipFR * H_thighFR * H_calfFR * H_footFR * originPos).head<3>();
    footPosMat.col(1) = (H_hipFL * H_thighFL * H_calfFL * H_footFL * originPos).head<3>();
    footPosMat.col(2) = (H_hipRR * H_thighRR * H_calfRR * H_footRR * originPos).head<3>();
    footPosMat.col(3) = (H_hipRL * H_thighRL * H_calfRL * H_footRL * originPos).head<3>();

    return footPosMat;

}

Eigen::MatrixXd go1FootJacHardware(const Eigen::VectorXd& jointPos, const Eigen::Vector3d& root_rpy) {
/*
    Finds the Jacobian connecting the joint velocities to their corresponding
    linear foot velocities. One Jacobian is constructed per foot, and then is
    stacked on top of each other for convenient access. Based on joint positions
    relayed to it from hardware.
*/
    double roll = root_rpy(0);
    double pitch = root_rpy(1);
    double yaw = root_rpy(2);

    double qFR0 = jointPos[0], qFR1 = jointPos[1], qFR2 = jointPos[2];
    double qFL0 = jointPos[3], qFL1 = jointPos[4], qFL2 = jointPos[5];
    double qRR0 = jointPos[6], qRR1 = jointPos[7], qRR2 = jointPos[8];
    double qRL0 = jointPos[9], qRL1 = jointPos[10], qRL2 = jointPos[11];

    Eigen::MatrixXd JvFR(3, 18);
    Eigen::MatrixXd JvFL(3, 18);
    Eigen::MatrixXd JvRR(3, 18);
    Eigen::MatrixXd JvRL(3, 18);

    JvFR << 1.0, 0, 0, (213.0*sin(qFR1)*sin(qFR2)*(cos(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000.0 - (187.0*sin(roll)*sin(yaw))/4000.0 - (2.0*cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25.0 - (2.0*sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25.0 - (213.0*cos(qFR1)*(cos(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000.0 - (213.0*cos(qFR1)*cos(qFR2)*(cos(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000.0 - (187.0*cos(roll)*cos(yaw)*sin(pitch))/4000.0, (213.0*sin(qFR2)*(sin(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qFR0)*sin(roll)) + cos(qFR1)*cos(yaw)*sin(pitch)))/1000.0 - (213.0*cos(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qFR0)*sin(roll)))/1000.0 - (213.0*cos(qFR2)*(cos(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qFR0)*sin(roll)) - cos(yaw)*sin(pitch)*sin(qFR1)))/1000.0 - (1881.0*cos(yaw)*sin(pitch))/10000.0 + (213.0*cos(yaw)*sin(pitch)*sin(qFR1))/1000.0 - (187.0*cos(pitch)*cos(yaw)*sin(roll))/4000.0 - (2.0*cos(pitch)*cos(qFR0)*cos(yaw)*sin(roll))/25.0 - (2.0*cos(pitch)*cos(roll)*cos(yaw)*sin(qFR0))/25.0, (187*cos(roll)*cos(yaw))/4000 - (213*cos(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 - (1881*cos(pitch)*sin(yaw))/10000 - (213*cos(qFR2)*(cos(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qFR1)*sin(yaw)))/1000 + (2*cos(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 + (213*sin(qFR2)*(sin(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qFR1)*sin(yaw)))/1000 - (2*sin(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (213*cos(pitch)*sin(qFR1)*sin(yaw))/1000 + (187*sin(pitch)*sin(roll)*sin(yaw))/4000, (213*sin(qFR1)*sin(qFR2)*(cos(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (2*cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 - (2*sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 - (213*cos(qFR1)*(cos(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (213*cos(qFR1)*cos(qFR2)*(cos(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000,   (213*sin(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 + (213*cos(qFR2)*(sin(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qFR1)*cos(yaw)))/1000 + (213*sin(qFR2)*(cos(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qFR1)))/1000 - (213*cos(pitch)*cos(qFR1)*cos(yaw))/1000,   (213*cos(qFR2)*(sin(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qFR1)*cos(yaw)))/1000 + (213*sin(qFR2)*(cos(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qFR1)))/1000, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 1.0, 0, (213*cos(qFR1)*(cos(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (187*cos(yaw)*sin(roll))/4000 + (2*cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (2*sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 - (187*cos(roll)*sin(pitch)*sin(yaw))/4000 - (213*sin(qFR1)*sin(qFR2)*(cos(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qFR1)*cos(qFR2)*(cos(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, (213*sin(qFR2)*(sin(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qFR0)*sin(roll)*sin(yaw)) + cos(qFR1)*sin(pitch)*sin(yaw)))/1000 - (1881*sin(pitch)*sin(yaw))/10000 - (213*cos(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qFR0)*sin(roll)*sin(yaw)))/1000 - (213*cos(qFR2)*(cos(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qFR0)*sin(roll)*sin(yaw)) - sin(pitch)*sin(qFR1)*sin(yaw)))/1000 - (187*cos(pitch)*sin(roll)*sin(yaw))/4000 + (213*sin(pitch)*sin(qFR1)*sin(yaw))/1000 - (2*cos(pitch)*cos(qFR0)*sin(roll)*sin(yaw))/25 - (2*cos(pitch)*cos(roll)*sin(qFR0)*sin(yaw))/25, (1881*cos(pitch)*cos(yaw))/10000 - (213*cos(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 + (187*cos(roll)*sin(yaw))/4000 - (213*cos(qFR2)*(cos(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qFR1)))/1000 + (213*sin(qFR2)*(sin(qFR1)*(cos(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qFR1)*cos(yaw)))/1000 + (2*cos(qFR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 - (2*sin(qFR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 - (187*cos(yaw)*sin(pitch)*sin(roll))/4000 - (213*cos(pitch)*cos(yaw)*sin(qFR1))/1000, (213*cos(qFR1)*(cos(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (2*cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (2*sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 - (213*sin(qFR1)*sin(qFR2)*(cos(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qFR1)*cos(qFR2)*(cos(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, - (213*sin(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 - (213*cos(qFR2)*(sin(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qFR1)*sin(yaw)))/1000 - (213*sin(qFR2)*(cos(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qFR1)*sin(yaw)))/1000 - (213*cos(pitch)*cos(qFR1)*sin(yaw))/1000, - (213*cos(qFR2)*(sin(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qFR1)*sin(yaw)))/1000 - (213*sin(qFR2)*(cos(qFR1)*(cos(qFR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qFR1)*sin(yaw)))/1000, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 1.0,                                                                                                                                                                                                                                                                                                          (213*cos(qFR1)*(cos(pitch)*cos(qFR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFR0)))/1000 - (187*cos(pitch)*cos(roll))/4000 + (213*cos(qFR1)*cos(qFR2)*(cos(pitch)*cos(qFR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFR0)))/1000 - (213*sin(qFR1)*sin(qFR2)*(cos(pitch)*cos(qFR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFR0)))/1000 - (2*cos(pitch)*cos(qFR0)*cos(roll))/25 + (2*cos(pitch)*sin(qFR0)*sin(roll))/25,                                                                                                                      (213*cos(pitch)*sin(qFR1))/1000 - (1881*cos(pitch))/10000 + (187*sin(pitch)*sin(roll))/4000 + (213*cos(qFR2)*(cos(pitch)*sin(qFR1) - cos(qFR1)*(sin(pitch)*sin(qFR0)*sin(roll) - cos(qFR0)*cos(roll)*sin(pitch))))/1000 + (213*sin(qFR2)*(cos(pitch)*cos(qFR1) + sin(qFR1)*(sin(pitch)*sin(qFR0)*sin(roll) - cos(qFR0)*cos(roll)*sin(pitch))))/1000 - (213*cos(qFR1)*(sin(pitch)*sin(qFR0)*sin(roll) - cos(qFR0)*cos(roll)*sin(pitch)))/1000 + (2*cos(qFR0)*sin(pitch)*sin(roll))/25 + (2*cos(roll)*sin(pitch)*sin(qFR0))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                 (213*cos(qFR1)*(cos(pitch)*cos(qFR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFR0)))/1000 + (213*cos(qFR1)*cos(qFR2)*(cos(pitch)*cos(qFR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFR0)))/1000 - (213*sin(qFR1)*sin(qFR2)*(cos(pitch)*cos(qFR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFR0)))/1000 - (2*cos(pitch)*cos(qFR0)*cos(roll))/25 + (2*cos(pitch)*sin(qFR0)*sin(roll))/25,                                                                                                                                                                                                                              (213*cos(qFR1)*sin(pitch))/1000 + (213*cos(qFR2)*(cos(qFR1)*sin(pitch) + sin(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll) - cos(pitch)*sin(qFR0)*sin(roll))))/1000 - (213*sin(qFR2)*(sin(pitch)*sin(qFR1) - cos(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll) - cos(pitch)*sin(qFR0)*sin(roll))))/1000 + (213*sin(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll) - cos(pitch)*sin(qFR0)*sin(roll)))/1000,                                                                                                                                                     (213*cos(qFR2)*(cos(qFR1)*sin(pitch) + sin(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll) - cos(pitch)*sin(qFR0)*sin(roll))))/1000 - (213*sin(qFR2)*(sin(pitch)*sin(qFR1) - cos(qFR1)*(cos(pitch)*cos(qFR0)*cos(roll) - cos(pitch)*sin(qFR0)*sin(roll))))/1000, 0, 0, 0, 0, 0, 0, 0, 0, 0;

    JvFL << 1.0, 0, 0, (187*sin(roll)*sin(yaw))/4000 - (213*cos(qFL1)*(cos(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 + (2*cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 + (2*sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 + (213*sin(qFL1)*sin(qFL2)*(cos(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (213*cos(qFL1)*cos(qFL2)*(cos(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 + (187*cos(roll)*cos(yaw)*sin(pitch))/4000, (213*sin(qFL2)*(sin(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qFL0)*sin(roll)) + cos(qFL1)*cos(yaw)*sin(pitch)))/1000 - (213*cos(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qFL0)*sin(roll)))/1000 - (213*cos(qFL2)*(cos(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qFL0)*sin(roll)) - cos(yaw)*sin(pitch)*sin(qFL1)))/1000 - (1881*cos(yaw)*sin(pitch))/10000 + (213*cos(yaw)*sin(pitch)*sin(qFL1))/1000 + (187*cos(pitch)*cos(yaw)*sin(roll))/4000 + (2*cos(pitch)*cos(qFL0)*cos(yaw)*sin(roll))/25 + (2*cos(pitch)*cos(roll)*cos(yaw)*sin(qFL0))/25, (213*sin(qFL2)*(sin(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qFL1)*sin(yaw)))/1000 - (213*cos(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 - (1881*cos(pitch)*sin(yaw))/10000 - (213*cos(qFL2)*(cos(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qFL1)*sin(yaw)))/1000 - (2*cos(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 - (187*cos(roll)*cos(yaw))/4000 + (2*sin(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (213*cos(pitch)*sin(qFL1)*sin(yaw))/1000 - (187*sin(pitch)*sin(roll)*sin(yaw))/4000, 0, 0, 0, (2*cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 - (213*cos(qFL1)*(cos(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 + (2*sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 + (213*sin(qFL1)*sin(qFL2)*(cos(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (213*cos(qFL1)*cos(qFL2)*(cos(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000,   (213*sin(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 + (213*cos(qFL2)*(sin(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qFL1)*cos(yaw)))/1000 + (213*sin(qFL2)*(cos(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qFL1)))/1000 - (213*cos(pitch)*cos(qFL1)*cos(yaw))/1000,   (213*cos(qFL2)*(sin(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qFL1)*cos(yaw)))/1000 + (213*sin(qFL2)*(cos(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qFL1)))/1000, 0, 0, 0, 0, 0, 0,
            0, 1.0, 0, (213*cos(qFL1)*(cos(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 - (187*cos(yaw)*sin(roll))/4000 - (2*cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 - (2*sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 + (187*cos(roll)*sin(pitch)*sin(yaw))/4000 - (213*sin(qFL1)*sin(qFL2)*(cos(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qFL1)*cos(qFL2)*(cos(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, (213*sin(qFL2)*(sin(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qFL0)*sin(roll)*sin(yaw)) + cos(qFL1)*sin(pitch)*sin(yaw)))/1000 - (1881*sin(pitch)*sin(yaw))/10000 - (213*cos(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qFL0)*sin(roll)*sin(yaw)))/1000 - (213*cos(qFL2)*(cos(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qFL0)*sin(roll)*sin(yaw)) - sin(pitch)*sin(qFL1)*sin(yaw)))/1000 + (187*cos(pitch)*sin(roll)*sin(yaw))/4000 + (213*sin(pitch)*sin(qFL1)*sin(yaw))/1000 + (2*cos(pitch)*cos(qFL0)*sin(roll)*sin(yaw))/25 + (2*cos(pitch)*cos(roll)*sin(qFL0)*sin(yaw))/25, (1881*cos(pitch)*cos(yaw))/10000 - (213*cos(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 - (187*cos(roll)*sin(yaw))/4000 - (213*cos(qFL2)*(cos(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qFL1)))/1000 + (213*sin(qFL2)*(sin(qFL1)*(cos(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qFL1)*cos(yaw)))/1000 - (2*cos(qFL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 + (2*sin(qFL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 + (187*cos(yaw)*sin(pitch)*sin(roll))/4000 - (213*cos(pitch)*cos(yaw)*sin(qFL1))/1000, 0, 0, 0, (213*cos(qFL1)*(cos(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 - (2*cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 - (2*sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 - (213*sin(qFL1)*sin(qFL2)*(cos(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qFL1)*cos(qFL2)*(cos(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, - (213*sin(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 - (213*cos(qFL2)*(sin(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qFL1)*sin(yaw)))/1000 - (213*sin(qFL2)*(cos(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qFL1)*sin(yaw)))/1000 - (213*cos(pitch)*cos(qFL1)*sin(yaw))/1000, - (213*cos(qFL2)*(sin(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qFL1)*sin(yaw)))/1000 - (213*sin(qFL2)*(cos(qFL1)*(cos(qFL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qFL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qFL1)*sin(yaw)))/1000, 0, 0, 0, 0, 0, 0,
            0, 0, 1.0,                                                                                                                                                                                                                                                                                                          (187*cos(pitch)*cos(roll))/4000 + (213*cos(qFL1)*(cos(pitch)*cos(qFL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFL0)))/1000 + (213*cos(qFL1)*cos(qFL2)*(cos(pitch)*cos(qFL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFL0)))/1000 - (213*sin(qFL1)*sin(qFL2)*(cos(pitch)*cos(qFL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFL0)))/1000 + (2*cos(pitch)*cos(qFL0)*cos(roll))/25 - (2*cos(pitch)*sin(qFL0)*sin(roll))/25,                                                                                                                      (213*cos(pitch)*sin(qFL1))/1000 - (1881*cos(pitch))/10000 - (187*sin(pitch)*sin(roll))/4000 + (213*cos(qFL2)*(cos(pitch)*sin(qFL1) - cos(qFL1)*(sin(pitch)*sin(qFL0)*sin(roll) - cos(qFL0)*cos(roll)*sin(pitch))))/1000 + (213*sin(qFL2)*(cos(pitch)*cos(qFL1) + sin(qFL1)*(sin(pitch)*sin(qFL0)*sin(roll) - cos(qFL0)*cos(roll)*sin(pitch))))/1000 - (213*cos(qFL1)*(sin(pitch)*sin(qFL0)*sin(roll) - cos(qFL0)*cos(roll)*sin(pitch)))/1000 - (2*cos(qFL0)*sin(pitch)*sin(roll))/25 - (2*cos(roll)*sin(pitch)*sin(qFL0))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0, 0, 0, 0,                                                                                                                                                                                                                                                                 (213*cos(qFL1)*(cos(pitch)*cos(qFL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFL0)))/1000 + (213*cos(qFL1)*cos(qFL2)*(cos(pitch)*cos(qFL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFL0)))/1000 - (213*sin(qFL1)*sin(qFL2)*(cos(pitch)*cos(qFL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qFL0)))/1000 + (2*cos(pitch)*cos(qFL0)*cos(roll))/25 - (2*cos(pitch)*sin(qFL0)*sin(roll))/25,                                                                                                                                                                                                                              (213*cos(qFL1)*sin(pitch))/1000 + (213*cos(qFL2)*(cos(qFL1)*sin(pitch) + sin(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll) - cos(pitch)*sin(qFL0)*sin(roll))))/1000 - (213*sin(qFL2)*(sin(pitch)*sin(qFL1) - cos(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll) - cos(pitch)*sin(qFL0)*sin(roll))))/1000 + (213*sin(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll) - cos(pitch)*sin(qFL0)*sin(roll)))/1000,                                                                                                                                                     (213*cos(qFL2)*(cos(qFL1)*sin(pitch) + sin(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll) - cos(pitch)*sin(qFL0)*sin(roll))))/1000 - (213*sin(qFL2)*(sin(pitch)*sin(qFL1) - cos(qFL1)*(cos(pitch)*cos(qFL0)*cos(roll) - cos(pitch)*sin(qFL0)*sin(roll))))/1000, 0, 0, 0, 0, 0, 0;

    JvRR << 1.0, 0, 0, (213*sin(qRR1)*sin(qRR2)*(cos(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (187*sin(roll)*sin(yaw))/4000 - (2*cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 - (2*sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 - (213*cos(qRR1)*(cos(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (213*cos(qRR1)*cos(qRR2)*(cos(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (187*cos(roll)*cos(yaw)*sin(pitch))/4000, (1881*cos(yaw)*sin(pitch))/10000 - (213*cos(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qRR0)*sin(roll)))/1000 - (213*cos(qRR2)*(cos(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qRR0)*sin(roll)) - cos(yaw)*sin(pitch)*sin(qRR1)))/1000 + (213*sin(qRR2)*(sin(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qRR0)*sin(roll)) + cos(qRR1)*cos(yaw)*sin(pitch)))/1000 + (213*cos(yaw)*sin(pitch)*sin(qRR1))/1000 - (187*cos(pitch)*cos(yaw)*sin(roll))/4000 - (2*cos(pitch)*cos(qRR0)*cos(yaw)*sin(roll))/25 - (2*cos(pitch)*cos(roll)*cos(yaw)*sin(qRR0))/25, (187*cos(roll)*cos(yaw))/4000 - (213*cos(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 + (1881*cos(pitch)*sin(yaw))/10000 - (213*cos(qRR2)*(cos(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qRR1)*sin(yaw)))/1000 + (2*cos(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 + (213*sin(qRR2)*(sin(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qRR1)*sin(yaw)))/1000 - (2*sin(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (213*cos(pitch)*sin(qRR1)*sin(yaw))/1000 + (187*sin(pitch)*sin(roll)*sin(yaw))/4000, 0, 0, 0, 0, 0, 0, (213*sin(qRR1)*sin(qRR2)*(cos(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (2*cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 - (2*sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 - (213*cos(qRR1)*(cos(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (213*cos(qRR1)*cos(qRR2)*(cos(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000,   (213*sin(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 + (213*cos(qRR2)*(sin(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qRR1)*cos(yaw)))/1000 + (213*sin(qRR2)*(cos(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qRR1)))/1000 - (213*cos(pitch)*cos(qRR1)*cos(yaw))/1000,   (213*cos(qRR2)*(sin(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qRR1)*cos(yaw)))/1000 + (213*sin(qRR2)*(cos(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qRR1)))/1000, 0, 0, 0,
            0, 1.0, 0, (213*cos(qRR1)*(cos(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (187*cos(yaw)*sin(roll))/4000 + (2*cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (2*sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 - (187*cos(roll)*sin(pitch)*sin(yaw))/4000 - (213*sin(qRR1)*sin(qRR2)*(cos(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qRR1)*cos(qRR2)*(cos(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, (213*sin(qRR2)*(sin(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qRR0)*sin(roll)*sin(yaw)) + cos(qRR1)*sin(pitch)*sin(yaw)))/1000 + (1881*sin(pitch)*sin(yaw))/10000 - (213*cos(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qRR0)*sin(roll)*sin(yaw)))/1000 - (213*cos(qRR2)*(cos(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qRR0)*sin(roll)*sin(yaw)) - sin(pitch)*sin(qRR1)*sin(yaw)))/1000 - (187*cos(pitch)*sin(roll)*sin(yaw))/4000 + (213*sin(pitch)*sin(qRR1)*sin(yaw))/1000 - (2*cos(pitch)*cos(qRR0)*sin(roll)*sin(yaw))/25 - (2*cos(pitch)*cos(roll)*sin(qRR0)*sin(yaw))/25, (187*cos(roll)*sin(yaw))/4000 - (213*cos(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 - (1881*cos(pitch)*cos(yaw))/10000 - (213*cos(qRR2)*(cos(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qRR1)))/1000 + (213*sin(qRR2)*(sin(qRR1)*(cos(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qRR1)*cos(yaw)))/1000 + (2*cos(qRR0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 - (2*sin(qRR0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 - (187*cos(yaw)*sin(pitch)*sin(roll))/4000 - (213*cos(pitch)*cos(yaw)*sin(qRR1))/1000, 0, 0, 0, 0, 0, 0, (213*cos(qRR1)*(cos(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (2*cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (2*sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 - (213*sin(qRR1)*sin(qRR2)*(cos(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qRR1)*cos(qRR2)*(cos(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, - (213*sin(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 - (213*cos(qRR2)*(sin(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qRR1)*sin(yaw)))/1000 - (213*sin(qRR2)*(cos(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qRR1)*sin(yaw)))/1000 - (213*cos(pitch)*cos(qRR1)*sin(yaw))/1000, - (213*cos(qRR2)*(sin(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qRR1)*sin(yaw)))/1000 - (213*sin(qRR2)*(cos(qRR1)*(cos(qRR0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRR0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qRR1)*sin(yaw)))/1000, 0, 0, 0,
            0, 0, 1.0,                                                                                                                                                                                                                                                                                                          (213*cos(qRR1)*(cos(pitch)*cos(qRR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRR0)))/1000 - (187*cos(pitch)*cos(roll))/4000 + (213*cos(qRR1)*cos(qRR2)*(cos(pitch)*cos(qRR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRR0)))/1000 - (213*sin(qRR1)*sin(qRR2)*(cos(pitch)*cos(qRR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRR0)))/1000 - (2*cos(pitch)*cos(qRR0)*cos(roll))/25 + (2*cos(pitch)*sin(qRR0)*sin(roll))/25,                                                                                                                      (1881*cos(pitch))/10000 + (213*cos(pitch)*sin(qRR1))/1000 + (187*sin(pitch)*sin(roll))/4000 + (213*cos(qRR2)*(cos(pitch)*sin(qRR1) - cos(qRR1)*(sin(pitch)*sin(qRR0)*sin(roll) - cos(qRR0)*cos(roll)*sin(pitch))))/1000 + (213*sin(qRR2)*(cos(pitch)*cos(qRR1) + sin(qRR1)*(sin(pitch)*sin(qRR0)*sin(roll) - cos(qRR0)*cos(roll)*sin(pitch))))/1000 - (213*cos(qRR1)*(sin(pitch)*sin(qRR0)*sin(roll) - cos(qRR0)*cos(roll)*sin(pitch)))/1000 + (2*cos(qRR0)*sin(pitch)*sin(roll))/25 + (2*cos(roll)*sin(pitch)*sin(qRR0))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0, 0, 0, 0, 0, 0, 0,                                                                                                                                                                                                                                                                 (213*cos(qRR1)*(cos(pitch)*cos(qRR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRR0)))/1000 + (213*cos(qRR1)*cos(qRR2)*(cos(pitch)*cos(qRR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRR0)))/1000 - (213*sin(qRR1)*sin(qRR2)*(cos(pitch)*cos(qRR0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRR0)))/1000 - (2*cos(pitch)*cos(qRR0)*cos(roll))/25 + (2*cos(pitch)*sin(qRR0)*sin(roll))/25,                                                                                                                                                                                                                              (213*cos(qRR1)*sin(pitch))/1000 + (213*cos(qRR2)*(cos(qRR1)*sin(pitch) + sin(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll) - cos(pitch)*sin(qRR0)*sin(roll))))/1000 - (213*sin(qRR2)*(sin(pitch)*sin(qRR1) - cos(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll) - cos(pitch)*sin(qRR0)*sin(roll))))/1000 + (213*sin(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll) - cos(pitch)*sin(qRR0)*sin(roll)))/1000,                                                                                                                                                     (213*cos(qRR2)*(cos(qRR1)*sin(pitch) + sin(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll) - cos(pitch)*sin(qRR0)*sin(roll))))/1000 - (213*sin(qRR2)*(sin(pitch)*sin(qRR1) - cos(qRR1)*(cos(pitch)*cos(qRR0)*cos(roll) - cos(pitch)*sin(qRR0)*sin(roll))))/1000, 0, 0, 0;

    JvRL << 1.0, 0, 0, (187*sin(roll)*sin(yaw))/4000 - (213*cos(qRL1)*(cos(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 + (2*cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 + (2*sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 + (213*sin(qRL1)*sin(qRL2)*(cos(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (213*cos(qRL1)*cos(qRL2)*(cos(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 + (187*cos(roll)*cos(yaw)*sin(pitch))/4000, (1881*cos(yaw)*sin(pitch))/10000 - (213*cos(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qRL0)*sin(roll)))/1000 - (213*cos(qRL2)*(cos(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qRL0)*sin(roll)) - cos(yaw)*sin(pitch)*sin(qRL1)))/1000 + (213*sin(qRL2)*(sin(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll)*cos(yaw) - cos(pitch)*cos(yaw)*sin(qRL0)*sin(roll)) + cos(qRL1)*cos(yaw)*sin(pitch)))/1000 + (213*cos(yaw)*sin(pitch)*sin(qRL1))/1000 + (187*cos(pitch)*cos(yaw)*sin(roll))/4000 + (2*cos(pitch)*cos(qRL0)*cos(yaw)*sin(roll))/25 + (2*cos(pitch)*cos(roll)*cos(yaw)*sin(qRL0))/25, (1881*cos(pitch)*sin(yaw))/10000 - (213*cos(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 - (187*cos(roll)*cos(yaw))/4000 - (213*cos(qRL2)*(cos(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qRL1)*sin(yaw)))/1000 - (2*cos(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 + (213*sin(qRL2)*(sin(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qRL1)*sin(yaw)))/1000 + (2*sin(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 + (213*cos(pitch)*sin(qRL1)*sin(yaw))/1000 - (187*sin(pitch)*sin(roll)*sin(yaw))/4000, 0, 0, 0, 0, 0, 0, 0, 0, 0, (2*cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 - (213*cos(qRL1)*(cos(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 + (2*sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 + (213*sin(qRL1)*sin(qRL2)*(cos(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000 - (213*cos(qRL1)*cos(qRL2)*(cos(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)) - sin(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch))))/1000,   (213*sin(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 + (213*cos(qRL2)*(sin(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qRL1)*cos(yaw)))/1000 + (213*sin(qRL2)*(cos(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qRL1)))/1000 - (213*cos(pitch)*cos(qRL1)*cos(yaw))/1000,   (213*cos(qRL2)*(sin(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qRL1)*cos(yaw)))/1000 + (213*sin(qRL2)*(cos(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qRL1)))/1000,
            0, 1.0, 0, (213*cos(qRL1)*(cos(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 - (187*cos(yaw)*sin(roll))/4000 - (2*cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 - (2*sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 + (187*cos(roll)*sin(pitch)*sin(yaw))/4000 - (213*sin(qRL1)*sin(qRL2)*(cos(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qRL1)*cos(qRL2)*(cos(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, (213*sin(qRL2)*(sin(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qRL0)*sin(roll)*sin(yaw)) + cos(qRL1)*sin(pitch)*sin(yaw)))/1000 + (1881*sin(pitch)*sin(yaw))/10000 - (213*cos(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qRL0)*sin(roll)*sin(yaw)))/1000 - (213*cos(qRL2)*(cos(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll)*sin(yaw) - cos(pitch)*sin(qRL0)*sin(roll)*sin(yaw)) - sin(pitch)*sin(qRL1)*sin(yaw)))/1000 + (187*cos(pitch)*sin(roll)*sin(yaw))/4000 + (213*sin(pitch)*sin(qRL1)*sin(yaw))/1000 + (2*cos(pitch)*cos(qRL0)*sin(roll)*sin(yaw))/25 + (2*cos(pitch)*cos(roll)*sin(qRL0)*sin(yaw))/25, (213*sin(qRL2)*(sin(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) - cos(pitch)*cos(qRL1)*cos(yaw)))/1000 - (213*cos(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))))/1000 - (187*cos(roll)*sin(yaw))/4000 - (213*cos(qRL2)*(cos(qRL1)*(cos(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)) + sin(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll))) + cos(pitch)*cos(yaw)*sin(qRL1)))/1000 - (1881*cos(pitch)*cos(yaw))/10000 - (2*cos(qRL0)*(cos(roll)*sin(yaw) - cos(yaw)*sin(pitch)*sin(roll)))/25 + (2*sin(qRL0)*(sin(roll)*sin(yaw) + cos(roll)*cos(yaw)*sin(pitch)))/25 + (187*cos(yaw)*sin(pitch)*sin(roll))/4000 - (213*cos(pitch)*cos(yaw)*sin(qRL1))/1000, 0, 0, 0, 0, 0, 0, 0, 0, 0, (213*cos(qRL1)*(cos(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 - (2*cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)))/25 - (2*sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)))/25 - (213*sin(qRL1)*sin(qRL2)*(cos(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000 + (213*cos(qRL1)*cos(qRL2)*(cos(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw)) - sin(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw))))/1000, - (213*sin(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))))/1000 - (213*cos(qRL2)*(sin(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qRL1)*sin(yaw)))/1000 - (213*sin(qRL2)*(cos(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qRL1)*sin(yaw)))/1000 - (213*cos(pitch)*cos(qRL1)*sin(yaw))/1000, - (213*cos(qRL2)*(sin(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) + cos(pitch)*cos(qRL1)*sin(yaw)))/1000 - (213*sin(qRL2)*(cos(qRL1)*(cos(qRL0)*(cos(yaw)*sin(roll) - cos(roll)*sin(pitch)*sin(yaw)) + sin(qRL0)*(cos(roll)*cos(yaw) + sin(pitch)*sin(roll)*sin(yaw))) - cos(pitch)*sin(qRL1)*sin(yaw)))/1000,
            0, 0, 1.0,                                                                                                                                                                                                                                                                                                          (187*cos(pitch)*cos(roll))/4000 + (213*cos(qRL1)*(cos(pitch)*cos(qRL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRL0)))/1000 + (213*cos(qRL1)*cos(qRL2)*(cos(pitch)*cos(qRL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRL0)))/1000 - (213*sin(qRL1)*sin(qRL2)*(cos(pitch)*cos(qRL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRL0)))/1000 + (2*cos(pitch)*cos(qRL0)*cos(roll))/25 - (2*cos(pitch)*sin(qRL0)*sin(roll))/25,                                                                                                                      (1881*cos(pitch))/10000 + (213*cos(pitch)*sin(qRL1))/1000 - (187*sin(pitch)*sin(roll))/4000 + (213*cos(qRL2)*(cos(pitch)*sin(qRL1) - cos(qRL1)*(sin(pitch)*sin(qRL0)*sin(roll) - cos(qRL0)*cos(roll)*sin(pitch))))/1000 + (213*sin(qRL2)*(cos(pitch)*cos(qRL1) + sin(qRL1)*(sin(pitch)*sin(qRL0)*sin(roll) - cos(qRL0)*cos(roll)*sin(pitch))))/1000 - (213*cos(qRL1)*(sin(pitch)*sin(qRL0)*sin(roll) - cos(qRL0)*cos(roll)*sin(pitch)))/1000 - (2*cos(qRL0)*sin(pitch)*sin(roll))/25 - (2*cos(roll)*sin(pitch)*sin(qRL0))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,                                                                                                                                                                                                                                                                 (213*cos(qRL1)*(cos(pitch)*cos(qRL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRL0)))/1000 + (213*cos(qRL1)*cos(qRL2)*(cos(pitch)*cos(qRL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRL0)))/1000 - (213*sin(qRL1)*sin(qRL2)*(cos(pitch)*cos(qRL0)*sin(roll) + cos(pitch)*cos(roll)*sin(qRL0)))/1000 + (2*cos(pitch)*cos(qRL0)*cos(roll))/25 - (2*cos(pitch)*sin(qRL0)*sin(roll))/25,                                                                                                                                                                                                                              (213*cos(qRL1)*sin(pitch))/1000 + (213*cos(qRL2)*(cos(qRL1)*sin(pitch) + sin(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll) - cos(pitch)*sin(qRL0)*sin(roll))))/1000 - (213*sin(qRL2)*(sin(pitch)*sin(qRL1) - cos(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll) - cos(pitch)*sin(qRL0)*sin(roll))))/1000 + (213*sin(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll) - cos(pitch)*sin(qRL0)*sin(roll)))/1000,                                                                                                                                                     (213*cos(qRL2)*(cos(qRL1)*sin(pitch) + sin(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll) - cos(pitch)*sin(qRL0)*sin(roll))))/1000 - (213*sin(qRL2)*(sin(pitch)*sin(qRL1) - cos(qRL1)*(cos(pitch)*cos(qRL0)*cos(roll) - cos(pitch)*sin(qRL0)*sin(roll))))/1000;

    Eigen::MatrixXd go1Jac(JvFL.rows() + JvFR.rows() + JvRL.rows() + JvRR.rows(), JvFL.cols());
    go1Jac << JvFR,
        JvFL,
        JvRR,
        JvRL;

    return go1Jac;    
}